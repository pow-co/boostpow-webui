
<section class="">
  <h1><%= gettext "Proof of Work", name: "Phoenix" %></h1>
  <p>Mining memes for a better world</p>
  <div id="paypresto"></div>
  <div id="moneybutton"></div>
  <div id="relayx-button"></div>
</section>

<section class="row">
  <article class="column">
    <h2>Downloads</h2>
    <ul>
      <li>
        <a href="https://pow.co/linux">Linux</a>
      </li>
      <li>
        <a href="https://pow.co/mac">Mac</a>
      </li>
      <li>
        <a href="https://pow.co/windows">Windows</a>
      </li>
    </ul>
  </article>
  <article class="column">
    <h2>Help</h2>
    <ul>
      <li>
        <a href="https://t.me/joinchat/1Ivbis1nZJ80ZGU5">Telegram</a>
      </li>
      <li>
        <a href="https://twetch.app/u/58487">Twetch</a>
      </li>
    </ul>
  </article>
</section>

<section class="row">

  <h2>Latest Jobs</h2>
  <br/>
 
  <table>
    <%= for item <- @planarias do %>
    <tr>
      <td>
          <%= item.inserted_at %>
      </td>
      <td>
        <a href="https://whatsonchain.com/tx/<%=item.txid%>", target="_blank">
          <%= item.txid %>
        </a>
      </td>
    </tr>
    <% end %>
  </table>

</section>

<script>
  const {Presto, embed} = Paypresto

  //let script = '08626f6f7374706f7775040000000020dbe0f0cdeb0e399dde37764cdc84415d51c95a01c42a0037a3c639c7ae4fe0b304c0bd001d14726570617065746968770000000000000000000004000000002000000000000000000000000000000000000000000000000000000000000000007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac'
  let script = '626f6f7374706f77 OP_DROP 00000000 dbe0f0cdeb0e399dde37764cdc84415d51c95a01c42a0037a3c639c7ae4fe0b3 c0bd001d 7265706170657469687700000000000000000000 00000000 0000000000000000000000000000000000000000000000000000000000000000 OP_CAT OP_SWAP OP_5 OP_ROLL OP_DUP OP_TOALTSTACK OP_CAT OP_2 OP_PICK OP_TOALTSTACK OP_5 OP_ROLL OP_SIZE OP_4 OP_EQUALVERIFY OP_CAT OP_5 OP_ROLL OP_SIZE OP_8 OP_EQUALVERIFY OP_CAT OP_SWAP OP_CAT OP_HASH256 OP_SWAP OP_TOALTSTACK OP_CAT OP_CAT OP_SWAP OP_SIZE OP_4 OP_EQUALVERIFY OP_CAT OP_FROMALTSTACK OP_CAT OP_SWAP OP_SIZE OP_4 OP_EQUALVERIFY OP_CAT OP_HASH256 00 OP_CAT OP_BIN2NUM OP_FROMALTSTACK OP_SIZE OP_4 OP_EQUALVERIFY OP_3 OP_SPLIT OP_DUP OP_BIN2NUM OP_3 21 OP_WITHIN OP_VERIFY OP_TOALTSTACK OP_DUP OP_BIN2NUM 0 OP_GREATERTHAN OP_VERIFY 0000000000000000000000000000000000000000000000000000000000 OP_CAT OP_FROMALTSTACK OP_3 OP_SUB OP_8 OP_MUL OP_RSHIFT 00 OP_CAT OP_BIN2NUM OP_LESSTHAN OP_VERIFY OP_DUP OP_HASH160 OP_FROMALTSTACK OP_EQUALVERIFY OP_CHECKSIG'

  /*
  const payment = Presto.create({
    key: 'Kx2p4o7FYJYjEwufdYJLXjPtu2vaSpQ8mB7mjMJnaHnPSrGQ1nQk',
    description: 'Proof of Work',
    outputs: [
      { to: '1ErZaNaYtbUSfyXK8yc9dvH2ofMpw8r7DT', satoshis: 10000 },
      { script, satoshis: 10000 }
    ]
  })
 */

  const div = document.getElementById('moneybutton')
  moneyButton.render(div, {
    to: script,
    amount: 0.0001,
    currency: "BSV",
    onPayment: (arg) => {
      console.log('onPayment', arg)
    },
    onError: (arg) => { console.log('onError', arg) }
  })
  const relaydiv = document.querySelector('#relayx-button')
  relayone.render(relaydiv, {
    to: script,
    amount: 0.0001,
    currency: "BSV"
  })
  /*

  payment
    .mount(embed('#paypresto'))
    .on('funded', payment => payment.pushTx())
    .on('success', txid => {

       console.log('TX sent', txid)

        setTimeout(() => {

          $('#paypresto').innerHTML = null

        }, 1000)

     })
 */

</script>
